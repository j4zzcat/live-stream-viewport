var viewport;(()=>{var e={65:function(e,o,t){var n,r;!function(i,u){"use strict";n=function(){var e=function(){},o="undefined",t=typeof window!==o&&typeof window.navigator!==o&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],r={},i=null;function u(e,o){var t=e[o];if("function"==typeof t.bind)return t.bind(e);try{return Function.prototype.bind.call(t,e)}catch(o){return function(){return Function.prototype.apply.apply(t,[e,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(){for(var t=this.getLevel(),r=0;r<n.length;r++){var i=n[r];this[i]=r<t?e:this.methodFactory(i,t,this.name)}if(this.log=this.debug,typeof console===o&&t<this.levels.SILENT)return"No console available for logging"}function l(e){return function(){typeof console!==o&&(a.call(this),this[e].apply(this,arguments))}}function f(n,r,i){return function(n){return"debug"===n&&(n="log"),typeof console!==o&&("trace"===n&&t?c:void 0!==console[n]?u(console,n):void 0!==console.log?u(console,"log"):e)}(n)||l.apply(this,arguments)}function d(e,t){var u,c,l,d=this,s="loglevel";function g(){var e;if(typeof window!==o&&s){try{e=window.localStorage[s]}catch(e){}if(typeof e===o)try{var t=window.document.cookie,n=encodeURIComponent(s),r=t.indexOf(n+"=");-1!==r&&(e=/^([^;]+)/.exec(t.slice(r+n.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function p(e){var o=e;if("string"==typeof o&&void 0!==d.levels[o.toUpperCase()]&&(o=d.levels[o.toUpperCase()]),"number"==typeof o&&o>=0&&o<=d.levels.SILENT)return o;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?s+=":"+e:"symbol"==typeof e&&(s=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=t||f,d.getLevel=function(){return null!=l?l:null!=c?c:u},d.setLevel=function(e,t){return l=p(e),!1!==t&&function(e){var t=(n[e]||"silent").toUpperCase();if(typeof window!==o&&s){try{return void(window.localStorage[s]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(s)+"="+t+";"}catch(e){}}}(l),a.call(d)},d.setDefaultLevel=function(e){c=p(e),g()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,function(){if(typeof window!==o&&s){try{window.localStorage.removeItem(s)}catch(e){}try{window.document.cookie=encodeURIComponent(s)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),a.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(i!==d&&(u=p(i.getLevel())),a.call(d),i===d)for(var e in r)r[e].rebuild()},u=p(i?i.getLevel():"WARN");var v=g();null!=v&&(l=p(v)),a.call(d)}(i=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var o=r[e];return o||(o=r[e]=new d(e,i.methodFactory)),o};var s=typeof window!==o?window.log:void 0;return i.noConflict=function(){return typeof window!==o&&window.log===i&&(window.log=s),i},i.getLoggers=function(){return r},i.default=i,i},void 0===(r=n.call(o,t,o,e))||(e.exports=r)}()},463:function(e,o,t){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.SimplePlayer=void 0;var r=n(t(65)),i=function(){function e(e,o){var t=this;this.HOUSEKEEPING_INTERVAL_MESSAGES=100,this.CLEANUP_INTERVAL_SECONDS=20,this.KEEP_VIDEO_SECONDS=10,this._logger={info:function(e){r.default.info("[".concat(Date.now(),"] [").concat(t._videoElementId,"] ").concat(e))},warn:function(e){r.default.warn("[".concat(Date.now(),"] [").concat(t._videoElementId,"] ").concat(e))},error:function(e){r.default.error("[".concat(Date.now(),"] [").concat(t._videoElementId,"] ").concat(e))},debug:function(e){r.default.debug("[".concat(Date.now(),"] [").concat(t._videoElementId,"] ").concat(e))}},this.onSourceOpen=function(){t._ws=new WebSocket(t._url),t._ws.binaryType="arraybuffer",t._ws.onopen=function(){t._logger.info("Connected to the Simple Reflector")};var e=0,o=0,n=0,r=Date.now();t._ws.onmessage=function(i){if(1==++e){if(t._logger.debug("Processing message: 1"),i.data?t._mimeCodecs='video/mp4; codecs="'.concat(i.data,'"'):t._mimeCodecs='video/mp4; codecs="avc1.4d4032"',t._logger.info("mimeCodecs: ".concat(t._mimeCodecs)),!MediaSource.isTypeSupported(t._mimeCodecs))throw t._logger.error("Mime Codec not supported: ".concat(t._mimeCodecs)),new Error("Mime Codec not supported");return t._sourceBuffer=t._mediaSource.addSourceBuffer(t._mimeCodecs),t._queue=new u,void t._logger.info("Starting video")}e%t.HOUSEKEEPING_INTERVAL_MESSAGES==0&&(t._logger.debug("Processing message: ".concat(e,", starting housekeeping cycle")),t._logger.debug("queue.size: ".concat(t._queue.size(),", ")+"buffer start: ".concat(t._sourceBuffer.buffered.start(0),", ")+"buffer end: ".concat(t._sourceBuffer.buffered.end(0),", ")+"buffer size: ".concat(t._sourceBuffer.buffered.end(0)-t._sourceBuffer.buffered.start(0),", ")+"byte received: ".concat(o)),0==n&&Date.now()-r>1e3*t.CLEANUP_INTERVAL_SECONDS&&(r=Date.now(),n=1));var c=new Uint8Array(i.data);if(t._queue.enqueue(c),o+=c.length,0==t._sourceBuffer.updating){if(n>0){1==n?t._logger.debug("Starting cleanup cycle"):t._logger.error("Retrying cleanup cycle, this is attempt: ".concat(n));try{var a=t._sourceBuffer.buffered.end(0)-t._sourceBuffer.buffered.start(0);return t._logger.debug("Buffer size: ".concat(a)),a>t.KEEP_VIDEO_SECONDS&&(t._sourceBuffer.remove(0,t._sourceBuffer.buffered.end(0)-t.KEEP_VIDEO_SECONDS),t._logger.debug("Cleaning buffer")),t._logger.debug("SourceBuffer cleaned"),void(n=0)}catch(e){t._logger.debug("Failed to clean up SourceBuffer: ".concat(e)),n++}}new Uint8Array(i.data);try{t._sourceBuffer.appendBuffer(t.dehydrateQueue(t._queue))}catch(e){t._logger.error("Error, appendBuffer failed: ".concat(e))}}else t._sourceBuffer.onupdateend=function(){try{0==t._sourceBuffer.updating&&t._sourceBuffer.appendBuffer(t.dehydrateQueue(t._queue))}catch(e){t._logger.error("Error, appendBuffer failed inside onUpdateEnd: ".concat(e))}finally{t._sourceBuffer.onupdateend=void 0}}}},this._videoElementId=e,this._url=o,r.default.setLevel("INFO"),this._logger.info("Starting SimplePlayer"),this.initialize()}return e.prototype.initialize=function(){var e=this;if(this._videoElement=document.getElementById(this._videoElementId),null==this._videoElement)throw this._logger.error("Video element '".concat(this._videoElementId,"' not found")),new Error("Video element not found");if(!("MediaSource"in window))throw this._logger.error("MediaSource API is not available in your browser."),new Error("MSE not available");this._mediaSource=new MediaSource,this._videoElement.src=URL.createObjectURL(this._mediaSource),this._mediaSource.addEventListener("sourceopen",this.onSourceOpen),this._mediaSource.addEventListener("sourceended",(function(){e._logger.debug("onSourceEnded")})),this._mediaSource.addEventListener("sourceclose",(function(){e._logger.debug("onSourceClose")})),document.addEventListener("visibilitychange",(function(){0==document.hidden&&(e._logger.debug("Visibility changed: Focus"),e._sourceBuffer&&e._sourceBuffer.buffered&&(e._videoElement.currentTime=e._sourceBuffer.buffered.end(0)))}))},e.prototype.dehydrateQueue=function(e){for(var o=[],t=0;!this._queue.isEmpty();){var n=this._queue.dequeue();o.push(n),t+=n.length}for(var r=new Uint8Array(t),i=0,u=0,c=o;u<c.length;u++){var a=c[u];r.set(a,i),i+=a.length}return r},e}();o.SimplePlayer=i;var u=function(){function e(){this.queue=[]}return e.prototype.enqueue=function(e){this.queue.push(e)},e.prototype.dequeue=function(){return this.queue.shift()},e.prototype.peek=function(){return this.queue[0]},e.prototype.isEmpty=function(){return 0===this.queue.length},e.prototype.size=function(){return this.queue.length},e}()}},o={},t=function t(n){var r=o[n];if(void 0!==r)return r.exports;var i=o[n]={exports:{}};return e[n].call(i.exports,i,i.exports,t),i.exports}(463);viewport=t})();